<html>
<head>
	<title>Syntax prosody interface application</title>

	<link rel="stylesheet" type="text/css" href="spot.css">

	<script src="lib/jszip.min.js"></script>

	<!-- to keep spot.js in sync with the codebase make sure to run jsbuild.sh after making any changes to javascript files in the main directory or in the constraints sub-directory
	(open a terminal, cd into the main directory, type ./jsbuild.sh and hit enter) -->
	<script src="build/spot.js"></script>

<!--Change "YOUR_TREES_HERE" to the name of your tree file on the following line. Make sure your file is in main/trees-->
	<script src="trees/YOUR_TREES_HERE.js"></script>
			
</head>

<body style="padding-left: 5%; padding-right: 5%; padding-top: 20px">
	<h2>MY ANALYSIS: investigation using SPOT</h2>
	<pre id="results-container"></pre>

<script>
	//sTreeList is an array of variable names of syntactic trees, either from your tree file (trees/YOUR_TREES_HERE.js) or defined in this document.
	var sTreeList = [sTree1, sTree2];
	
	//Basic constraint sets
	var conMatch = ['matchSP-xp', 'matchPS-phi', 'equalSistersAdj'];
	var conAlign = ['alignRight-xp', 'alignLeft-xp', 'wrap-xp', 'equalSistersAdj'];
			
    var constraintSets_poster = ['conMatch', 'conAlign'];

    function makeTableauCsvs(consName) {
        var csvSegs = [];
        //For each tree in the current set of trees
        for(var j=0; j<sTreeList.length; j++){
            var currentSTree = globalNameOrDirect(sTreeList[j]); 
            var wordArray = getLeaves(currentSTree);
            var words = [];
            //make the string of terminals
            for(k=0; k<wordArray.length; k++){
                words.push(wordArray[k].id.split("_")[0]);
            }
            //make the candidate set
            var candSet = GEN(sTreeList[j], words, {obeysHeadedness: true});
            
            var tabl = makeTableau(candSet, window[consName]);
            csvSegs.push(tableauToCsv(tabl, '\t', {noHeader: j}));
        }
        //reveal one 
        revealNextSegment();
        lastSegmentId++;
		
        saveTextAs(csvSegs.join('\n'),"tableau_"+consName+".txt");
    }
	
    function runDemo() {
        makeTableauCsvs(constraintSets_poster[sTreeList]);
    }
    
    
    function saveAs(blob, name) {
        var a = document.createElement("a");
        a.display = "none";
        a.href = URL.createObjectURL(blob);
        a.download = name;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }
    
    function saveTextAs(text, name) {
        saveAs(new Blob([text], {type: "text/csv", encoding: 'utf-8'}), name);
    }

</script>

</body>

</html>
